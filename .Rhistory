install.packages("PalmerPenguins")
install.packages("palmerpenguins")
install.packages("pacman")
pacman::p_load("palmerpenguins")
pacman::p_load(c("palmerpenguins", "tidyverse"))
penguins
penguins %>%
ggplot(aes(bill_length_mm, flipper_length_mm, colour = factor(species))) +
geom_point(size = 3) +
theme_light()
pacman::p_load(c("palmerpenguins", "tidyverse"))
pacman::p_load(c("palmerpenguins", "magrittr", "ggplot2"))
penguins %>%
ggplot(aes(bill_length_mm, flipper_length_mm, colour = factor(species))) +
geom_point(size = 3) +
theme_light()
pacman::p_load("palmerpenguins", "magrittr", "ggplot2")
penguins %>%
ggplot(aes(bill_length_mm, flipper_length_mm, colour = factor(species))) +
geom_point(size = 3) +
theme_light()
penguins %>%
ggplot(aes(bill_length_mm, flipper_length_mm, colour = factor(species))) +
geom_point(size = 3) +
theme_light() +
facet_grid(rows = vars(island))
penguins %>%
ggplot(aes(bill_length_mm, flipper_length_mm, colour = factor(species))) +
geom_point(size = 3) +
theme_light() +
facet_grid(cols = vars(island))
plt <- penguins %>%
ggplot(aes(bill_length_mm, flipper_length_mm, colour = factor(species))) +
geom_point(size = 3) +
theme_light() +
facet_grid(cols = vars(island))
plotly::ggplotly(plt)
bio3d::read.pdb("1bna")
dna <- bio3d::read.pdb("1bna")
dna$xyz
library(bio3d)
atom.select.pdb(dna, resno = 1)
atom.select.pdb(dna, resno = 1)$xyz
atom.select.pdb(dna, resno = 1, value = TRUE)$atom
atom.select.pdb(dna, resno = 1, value = TRUE)$atom
pos <- atom.select.pdb(dna, resno = 1, value = TRUE)$atom
pos$x
library(tidyverse)
dna <- bio3d::read.pdb("1bna")
pos <- atom.select.pdb(dna, resno = 1, value = TRUE)$atom
pos %>%
mutate(
x = x - min(x),
y = y - min(y),
z = z - min(z)
)
atom.select.pdb(pos, elety = "C1'")
atom.select.pdb(dna, elety = "C1'", resno = 1)
atom.select.pdb(dna, elety = "C1'", resno = 1, value = TRUE)
c_c1 <- atom.select.pdb(dna, elety = "C1'", resno = 1, value = TRUE)
pos %>%
mutate(
x = x - c_c1$xyz$x,
y = y - c_c1$xyz$y,
z = z - c_c1$xyz$y
)
pos %>%
mutate(
x = x - c_c1$xyz$x,
y = y - c_c1$xyz$y,
z = z - c_c1$xyz$y
)
c_c1
c_c1$
pos %>%
mutate(
x = x - c_c1$atom$x,
y = y - c_c1$atom$y,
z = z - c_c1$atom$y
)
pos
pos %>%
mutate(
x = x - c_c1$atom$x,
y = y - c_c1$atom$y,
z = z - c_c1$atom$y
)
pos %>%
mutate(
x = x - c_c1$atom$x,
y = y - c_c1$atom$y,
z = z - c_c1$atom$z
)
values <- pos %>%
mutate(
x = x - c_c1$atom$x,
y = y - c_c1$atom$y,
z = z - c_c1$atom$z
)
pos
c_c1
c_tes <- c_c1
c_tes$atom <- values
r3dmol::m_glimpse(c_tes)
r3dmol::m_glimpse(c_tes, highlight = r3dmol::m_sel())
r3dmol::m_glimpse(c_tes, highlight = r3dmol::m_sel(resno = 1))
r3dmol::m_glimpse(c_tes, highlight = r3dmol::m_sel(resi = 1))
library(r3dmol)
r3dmol() %>%
m_add_model(m_bio3d(c_tes)) %>%
m_add_style()
r3dmol() %>%
m_add_model(m_bio3d(c_tes)) %>%
m_add_style(m_style_sphere())
r3dmol() %>%
m_add_model(m_bio3d(c_tes)) %>%
m_add_style(m_style_sphere()) %>%
m_zoom_to()
c_tes <- atom.select.pdb(dna, resno = 1, value = TRUE)
c_tes$atom <- values
r3dmol() %>%
m_add_model(m_bio3d(c_tes)) %>%
m_add_style(m_style_sphere()) %>%
m_zoom_to()
r3dmol() %>%
m_add_model(m_bio3d(c_tes)) %>%
m_add_style(m_style_sphere(scale = 0.2)) %>%
m_zoom_to()
c_tes$atom %>%
as_tibble()
r3dmol() %>%
m_add_model(m_fetch_pdb("1bna")) %>%
m_add_style(m_style_sphere(scale = 0.2)) %>%
m_zoom_to()
r3dmol() %>%
m_add_model(m_fetch_pdb("1bna")) %>%
m_add_style(m_style_ballnstick()) %>%
m_zoom_to()
library(tidyverse)
read.table("G:/bjohnston/BAJ_01/HILLS")
read.table("G:/bjohnston/BAJ_01/HILLS") %>%
as_tibble()
df <- read.table("G:/bjohnston/BAJ_01/HILLS") %>%
as_tibble()
mdfret::readhills("G:/bjohnston/BAJ_01/HILLS")
mdfret::readhills("G:/bjohnston/BAJ_01/HILLS") %>%
as_tibble()
df <- mdfret::readhills("G:/bjohnston/BAJ_01/HILLS") %>%
as_tibble()
df %>%
filter(time == 1)
df %>%
filter(time == 2)
df %>%
filter(time < 2)
mdfret::readcolvar("G:/bjohnston/BAJ_01/COLVAR_METAD")
df <- mdfret::readcolvar("G:/bjohnston/BAJ_01/COLVAR_METAD") %>%
as_tibble
df <- mdfret::readcolvar("G:/bjohnston/BAJ_01/COLVAR_METAD") %>%
as_tibble()
df
mdfret::readfes("G:/bjohnston/BAJ_01/fes_500000.dat")
mdfret::readfes("G:/bjohnston/BAJ_01/fes_500000_wall.dat")
remotes::install_github("bradyajohnston/readfes")
remotes::install_github("bradyajohnston/mdfret")
source("~/.active-rstudio-document", echo=TRUE)
df <- mdfret::readfes("G:/bjohnston/BAJ_01/fes_500000_wall.dat") %>%
as_tibble()
df
df %>%
select(sss.sss, zzz.zzz, ff1)
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zz
)
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zzz
)
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zzz
) %>%
as.matrix()
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zzz
) %>%
as.matrix() %>%
image()
mat <-
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zzz
) %>%
as.matrix()
dim(mat)
mat[, 500]
mat[, 450]
mat[, 400]
mat[, 380]
mat[, 420]
mat[, 430]
mat[, 500]
mat[, 490]
mat[, 480]
mat[, 470]
mat[, 460]
mat[, 4455]
mat[, 445]
mat[, 455]
mat[, 430]
vec <- mat[, 430]
which.min(vec)
some_function <- function(vec) {
sapply(seq(length(vec)), \(x) {
global_min <- which.min(vec)
vec[global_min] <<- 0
global_min
})
}
some_function(vec)
some_function <- function(vec) {
vec <- ifelse(vec == Inf, 0, vec)
sapply(seq(length(vec)), \(x) {
global_min <- which.max(vec)
vec[global_min] <<- 0
global_min
})
}
some_function(vec)
df <- mdfret::readfes("G:/bjohnston/BAJ_02/fes_500000_wall.dat") %>%
as_tibble()
df
mat <-
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zzz
) %>%
as.matrix()
vec <- mat[, 430]
image(vec)
image(mat)
df <- mdfret::readfes("G:/bjohnston/BAJ_03/fes_500000_wall.dat") %>%
as_tibble()
df
mat <-
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zzz
) %>%
as.matrix()
image(mat)
df <- mdfret::readfes("G:/bjohnston/protein//fes_500000_wall.dat") %>%
as_tibble()
df <- mdfret::readfes("G:/bjohnston/protein/fes_500000_wall.dat") %>%
as_tibble()
df <- mdfret::readfes("G:/bjohnston/protein/protein_metad/fes_500000_wall.dat") %>%
as_tibble()
df
mat <-
df %>%
select(sss.sss, zzz.zzz, ff1) %>%
pivot_wider(
values_from = ff1,
names_from = zzz.zzz
) %>%
as.matrix()
image(mat)
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
geom_raster()
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
geom_tile()
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
geom_tile(colour = "na")
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
geom_tile(colour = NA)
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
geom_tile(colour = NA) +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion())
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
geom_tile(colour = NA) +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion()) +
coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion()) +
coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL +
scale_fill_viridis_c()
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL +
scale_fill_viridis_c(
option = "A"
)
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL +
scale_fill_viridis_c(
option = "A",
direction = -1
)
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(expand = expansion()) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL +
scale_fill_viridis_c(
option = "A",
direction = -1,
oob = scales::oob_squish_infinite
)
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(
expand = expansion(),
breaks = 0:12
) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL +
scale_fill_viridis_c(
option = "A",
direction = -1,
oob = scales::oob_squish_infinite
)
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(
expand = expansion(),
breaks = 0:11
) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL +
scale_fill_viridis_c(
option = "A",
direction = -1,
oob = scales::oob_squish_infinite
)
df %>%
ggplot(aes(sss.sss, zzz.zzz, fill = ff1)) +
# geom_tile(colour = NA, ) +
geom_raster() +
scale_x_continuous(
expand = expansion(),
breaks = 0:11
) +
scale_y_continuous(expand = expansion()) +
# coord_cartesian(xlim = c(2,3), ylim = c(0.1, 0.2))
NULL +
scale_fill_viridis_c(
option = "A",
direction = -1,
oob = scales::oob_squish_infinite
) +
coord_equal()
